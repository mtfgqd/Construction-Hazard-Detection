import{clearToken as s,setToken as i}from"./common-Ceipz8Vt.js";const d="/api";document.addEventListener("DOMContentLoaded",()=>{const n=document.getElementById("login-form"),e=document.getElementById("login-error");n.addEventListener("submit",t=>c(t,e))});async function c(n,e){n.preventDefault();const{username:t,password:o}=m();if(!t||!o){a(e,"Username and password are required.");return}try{await u(t,o),l()}catch(r){a(e,r.message||"Error logging in.")}}function m(){const n=document.getElementById("username").value.trim(),e=document.getElementById("password").value.trim();return{username:n,password:e}}async function u(n,e){s();const t=await fetch(`${d}/token`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:e})});if(!t.ok){const r=await t.json();throw new Error(r.detail||"Login failed.")}const o=await t.json();i(o.access_token)}function l(){window.location.href="./index.html"}function a(n,e){n.textContent=e}
