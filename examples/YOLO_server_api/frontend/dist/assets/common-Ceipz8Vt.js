(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const n of o)if(n.type==="childList")for(const i of n.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(o){const n={};return o.integrity&&(n.integrity=o.integrity),o.referrerPolicy&&(n.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?n.credentials="include":o.crossOrigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function s(o){if(o.ep)return;o.ep=!0;const n=t(o);fetch(o.href,n)}})();function l(){return localStorage.getItem("access_token")}function a(r){localStorage.setItem("access_token",r)}function f(){localStorage.removeItem("access_token")}function c(r){if(!r)return!0;try{const e=JSON.parse(atob(r.split(".")[1])),t=Math.floor(Date.now()/1e3);return e.exp&&e.exp<t}catch(e){return console.error("Error parsing token:",e),!0}}function u(){var e;const r=l();if(!r||c(r))return null;try{const t=JSON.parse(atob(r.split(".")[1]));return((e=t==null?void 0:t.subject)==null?void 0:e.role)||null}catch(t){return console.error("Error parsing token payload:",t),null}}function d(){var e;const r=l();if(!r||c(r))return null;try{const t=JSON.parse(atob(r.split(".")[1]));return((e=t==null?void 0:t.subject)==null?void 0:e.username)||null}catch(t){return console.error("Error parsing token payload:",t),null}}function m(){const r=l();return!r||c(r)?{}:{Authorization:`Bearer ${r}`}}function p(r=[]){const e=l();if(!e||c(e)){window.location.href="./login.html";return}const t=u();r.length>0&&!r.includes(t)&&(window.location.href="./index.html")}function y(){const r=u();r&&(r==="admin"?(document.querySelectorAll(".admin-only").forEach(e=>{e.style.display="inline-block"}),document.querySelectorAll(".model-manager-only").forEach(e=>{e.style.display="inline-block"})):r==="model_manager"?document.querySelectorAll(".model-manager-only").forEach(e=>{e.style.display="inline-block"}):document.querySelectorAll(".admin-only, .model-manager-only").forEach(e=>{e.style.display="none"}))}export{m as authHeaders,p as checkAccess,f as clearToken,l as getToken,u as getUserRoleFromToken,d as getUsernameFromToken,a as setToken,y as showAppropriateLinks};
