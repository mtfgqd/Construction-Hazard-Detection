import{checkAccess as w,clearToken as h,authHeaders as s}from"./common-Ceipz8Vt.js";import"./headerFooterLoader-LYlhFStm.js";const o="/api";document.addEventListener("DOMContentLoaded",()=>{w(["admin"]);const l=document.getElementById("logout-btn");l&&l.addEventListener("click",()=>{h(),window.location.href="/login.html"});const p=document.getElementById("add-user-form"),d=document.getElementById("add-user-error");p.addEventListener("submit",async n=>{n.preventDefault(),d.textContent="";const a=document.getElementById("add-username").value.trim(),t=document.getElementById("add-password").value.trim(),e=document.getElementById("add-role").value;try{const r=await fetch(`${o}/add_user`,{method:"POST",headers:{"Content-Type":"application/json",...s()},body:JSON.stringify({username:a,password:t,role:e})});if(!r.ok){const v=await r.json();d.textContent=v.detail||"Failed to add user.";return}alert("User added successfully.")}catch{d.textContent="Error adding user."}});const y=document.getElementById("delete-user-form"),u=document.getElementById("delete-user-error");y.addEventListener("submit",async n=>{n.preventDefault(),u.textContent="";const a=document.getElementById("delete-username").value.trim();try{const t=await fetch(`${o}/delete_user`,{method:"POST",headers:{"Content-Type":"application/json",...s()},body:JSON.stringify({username:a})});if(!t.ok){const e=await t.json();u.textContent=e.detail||"Failed to delete user.";return}alert("User deleted successfully.")}catch{u.textContent="Error deleting user."}});const E=document.getElementById("update-username-form"),c=document.getElementById("update-username-error");E.addEventListener("submit",async n=>{n.preventDefault(),c.textContent="";const a=document.getElementById("old-username").value.trim(),t=document.getElementById("new-username").value.trim();try{const e=await fetch(`${o}/update_username`,{method:"PUT",headers:{"Content-Type":"application/json",...s()},body:JSON.stringify({old_username:a,new_username:t})});if(!e.ok){const r=await e.json();c.textContent=r.detail||"Failed to update username.";return}alert("Username updated successfully.")}catch{c.textContent="Error updating username."}});const g=document.getElementById("update-password-form"),m=document.getElementById("update-password-error");g.addEventListener("submit",async n=>{n.preventDefault(),m.textContent="";const a=document.getElementById("update-password-username").value.trim(),t=document.getElementById("new-password").value.trim();try{const e=await fetch(`${o}/update_password`,{method:"PUT",headers:{"Content-Type":"application/json",...s()},body:JSON.stringify({username:a,new_password:t})});if(!e.ok){const r=await e.json();m.textContent=r.detail||"Failed to update password.";return}alert("Password updated successfully.")}catch{m.textContent="Error updating password."}});const f=document.getElementById("set-active-status-form"),i=document.getElementById("set-active-status-error");f.addEventListener("submit",async n=>{n.preventDefault(),i.textContent="";const a=document.getElementById("active-status-username").value.trim(),t=document.getElementById("is-active").checked;try{const e=await fetch(`${o}/set_user_active_status`,{method:"PUT",headers:{"Content-Type":"application/json",...s()},body:JSON.stringify({username:a,is_active:t})});if(!e.ok){const r=await e.json();i.textContent=r.detail||"Failed to update active status.";return}alert("User active status updated successfully.")}catch{i.textContent="Error updating active status."}})});
